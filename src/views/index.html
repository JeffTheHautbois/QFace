<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <script type="application/javascript" src="https://cdn.rawgit.com/techfort/LokiJS/master/build/lokijs.min.js"></script>
        <script type="application/javascript" src="https://cdn.rawgit.com/techfort/LokiJS/master/build/loki-indexed-adapter.min.js"></script>
    </head>
    <body>
        <ul>
            <li> Crop the president!</li>
            <button id="cropper"> Crop image </button>
        </ul>
        <img id="obama" src="./data/obama.bmp" alt="no-goose">
    </body>

    <script type="application/javascript" src="./Turbo.asm.js"></script>
    <script type="application/javascript">
    let cropper = document.getElementById("cropper");
    let obama = document.getElementById("obama");

    let cropFace = function() {
        let ranOnce = false;
        return function() {
            if (!ranOnce) {
                ranOnce = true;
            } else {
                return;
            }

            Module.faceCropper_detectCropFace();
            obama.src = "data:image/jpg;base64," + db.getCollection("temporaryStorage").find()[0].image;
        };
    }

    cropper.onclick = cropFace();
    </script>
</html>
