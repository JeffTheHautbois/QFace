<!DOCTYPE html>
<html lang="en">
    <head>
    <script type="application/javascript" src="https://cdn.rawgit.com/techfort/LokiJS/master/build/lokijs.min.js"></script>
    <script type="application/javascript" src="https://cdn.rawgit.com/techfort/LokiJS/master/build/loki-indexed-adapter.min.js"></script>
    </head>
    <body>
        <ul>
            <li> Crop this duck! Set the new length below:</li>
            <input type="text" id="cropped-length" value=100>
            <button id="cropper"> Crop image </button>
        </ul>
        <img id="duck" src="./data/duck.bmp" alt="no-goose">
    </body>

    <script type="application/javascript" src="./Turbo.asm.js"></script>
    <script type="application/javascript">
    let cropper = document.getElementById("cropper");
    let croppedLengthInput = document.getElementById("cropped-length");
    let duck = document.getElementById("duck");

    let cropDuck = function() {
        let ranOnce = false;
        return function() {
            if (!ranOnce) {
                ranOnce = true;
            } else {
                return;
            }

            let length = window.parseInt(croppedLengthInput.value);
            let base64String = Module.duckCropper_cropDuckImageToSquare(length);
            duck.src = "data:image/bmp;base64," + btoa(base64String);
        };
    }

    cropper.onclick = cropDuck();


    </script>
</html>
